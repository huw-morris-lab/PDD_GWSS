######META-ANALYSIS SCRIPT######
##Download metal software
#http://csg.sph.umich.edu/abecasis/Metal/download/

SCHEME  STDERR
AVERAGEFREQ ON
MINMAXFREQ ON
CUSTOMVARIABLE TotalSampleSize
LABEL TotalSampleSize as N 

# LOAD INPUT FILES

# Enable Genomic control correction
GENOMICCONTROL ON

# === DESCRIBE AND PROCESS THE FIRST INPUT FILE ===
MARKER SNP
ALLELE effect_allele noneffect_allele
FREQ   MAF
EFFECT beta
STDERR se
PVALUE Pvalue
WEIGHT N 
PROCESS $DIR/${COHORT1}/RESULTS/${COHORT1}_METAL_hg19.tab

# === DESCRIBE AND PROCESS THE SECOND INPUT FILE ===
MARKER SNP
ALLELE effect_allele noneffect_allele
FREQ   MAF
EFFECT beta
STDERR se
PVALUE Pvalue
WEIGHT N 
PROCESS $DIR/${COHORT2}/RESULTS/${COHORT2}_METAL_hg19.tab

# === DESCRIBE AND PROCESS THE THIRD INPUT FILE ===
MARKER SNP
ALLELE effect_allele noneffect_allele
FREQ   MAF
EFFECT beta
STDERR se
PVALUE Pvalue
WEIGHT N 
PROCESS $DIR/${COHORT3}/RESULTS/${COHORT3}_METAL_hg19.tab

# === DESCRIBE AND PROCESS THE FOURTH INPUT FILE ===
MARKER SNP
ALLELE effect_allele noneffect_allele
FREQ   MAF
EFFECT beta
STDERR se
PVALUE Pvalue
WEIGHT N 
PROCESS $DIR/${COHORT4}/RESULTS/${COHORT4}_METAL_hg19.tab

OUTFILE SURVIVAL_DEMENTIA_META_ALL_COHORTS .tbl
ANALYZE HETEROGENEITY RANDOM

QUIT
